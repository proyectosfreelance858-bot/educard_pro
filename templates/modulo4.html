<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Módulo Ultra-Dinámico: Proporcionalidad y Porcentajes (P) | EDUCARD SAS</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&family=Instrument+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <style>
        /* ================================================================= */
        /* --- 1. VARIABLES, RESET Y ESTILOS GLOBALES (Minimalista y Dinámico) --- */
        /* ================================================================= */
        :root {
            --color-primary: #5c67ff; /* Azul Educard */
            --color-primary-light: #8e96ff;
            --color-primary-dark: #4b54ff; 
            --color-secondary: #ffc107; /* Amarillo Destacado */
            --color-background: #f0f3f8; /* Fondo más frío y moderno */
            --color-surface: #ffffff; /* Superficie Blanca */
            --color-text-dark: #1f2937; /* Texto Principal (Casi negro) */
            --color-text-subtle: #6b7280; /* Texto Secundario */
            --color-border: #e5e7eb;
            --color-success: #10b981; /* Verde más vibrante */
            --color-danger: #ef4444; /* Rojo moderno */
            --color-shadow-primary: rgba(92, 103, 255, 0.25);
            --font-heading: 'Outfit', sans-serif;
            --font-body: 'Instrument Sans', sans-serif;
            --header-height: 80px;
            --step-transition-duration: 0.6s; 
        }

        /* Reset Básico */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { 
            font-family: var(--font-body); 
            color: var(--color-text-dark); 
            background-color: var(--color-background); 
            line-height: 1.7; 
            overflow-x: hidden; 
            padding-top: var(--header-height); 
        }

        /* Contenedor y Tipografía */
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 0 5%; 
        }
        h1, h2, h3, h4 { 
            font-family: var(--font-heading); 
            font-weight: 700; 
            line-height: 1.2; 
        }
        h1 { font-size: 3.2rem; }
        
        /* DISEÑO DE TÍTULOS MINIMALISTA */
        h2 { 
            font-size: 2.5rem; 
            color: var(--color-text-dark); 
            padding-bottom: 5px;
            border-bottom: 4px solid var(--color-primary-light); /* Subrayado sutil */
            display: inline-block; 
            margin-bottom: 20px;
        }
        h3 { 
            font-size: 1.8rem; 
            color: var(--color-primary-dark); 
            margin-top: 30px; 
            font-weight: 700;
        }
        h4 { 
            font-size: 1.3rem; 
            color: var(--color-text-dark); 
            margin-top: 20px; 
            font-weight: 600; 
            border-left: 5px solid var(--color-secondary); /* Pequeño acento */
            padding-left: 15px;
        }
        p { margin-bottom: 15px; }

        .section-header { text-align: center; margin-bottom: 50px; }
        .section-title { font-size: 2.8rem; font-weight: 800; margin-bottom: 15px; }
        .section-subtitle { font-size: 1.2rem; color: var(--color-text-subtle); max-width: 800px; margin: 0 auto; }
        
        /* Botones (CTA) - Se mantienen dinámicos */
        .btn {
            display: inline-flex; 
            align-items: center;
            gap: 8px;
            padding: 14px 28px; 
            border-radius: 10px; 
            text-decoration: none; 
            font-weight: 700; 
            font-size: 1rem; 
            transition: background-color 0.3s ease, transform 0.2s, box-shadow 0.3s; 
            border: none; 
            cursor: pointer;
        }

        .btn-primary {
            background-color: var(--color-primary); 
            color: white;
            box-shadow: 0 6px 15px var(--color-shadow-primary);
        }
        .btn-primary:hover { 
            background-color: var(--color-primary-dark); 
            transform: translateY(-2px); 
            box-shadow: 0 8px 20px var(--color-shadow-primary); 
        }

        .btn-outline {
            background-color: transparent;
            color: var(--color-primary);
            border: 2px solid var(--color-primary);
            box-shadow: none;
        }
        .btn-outline:hover {
            background-color: var(--color-primary);
            color: white;
        }

        /* DISEÑO DE TARJETAS MINIMALISTA Y DINÁMICO */
        .card {
            background-color: var(--color-surface);
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); /* Sombra ligera */
            margin-bottom: 25px;
            border: 1px solid var(--color-border); /* Borde sutil */
            border-left: 6px solid var(--color-primary); /* Fuerte acento de color primario */
            transition: transform 0.3s ease, box-shadow 0.3s ease; /* Efecto dinámico */
            animation: fadeIn 0.8s ease-out; /* Animación de entrada */
        }
        .card:hover {
             transform: translateY(-3px); /* Efecto levitación */
             box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .alert {
            padding: 18px;
            border-radius: 10px;
            margin-top: 25px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .alert i { font-size: 1.4rem; }
        .alert-info { background-color: #e0f2fe; color: #0284c7; border: 1px solid #7dd3fc; }
        .alert-success { background-color: #d1fae5; color: var(--color-success); border: 1px solid #a7f3d0; }
        .alert-danger { background-color: #fee2e2; color: var(--color-danger); border: 1px solid #fecaca; }
        .alert-warning { background-color: #fffbeb; color: #d97706; border: 1px solid #fcd34d; }

        /* Estilos para las Tablas de Fórmulas */
        .formula-table {
            width: 100%;
            margin: 30px auto;
            border-collapse: separate;
            border-spacing: 0 12px; 
            font-family: var(--font-body);
            font-size: 1.1rem;
            text-align: left;
        }
        .formula-table th, .formula-table td {
            padding: 18px 25px;
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
        }
        .formula-table th {
            background-color: var(--color-primary);
            color: white;
            font-weight: 700;
            border: none;
            text-align: center;
            font-size: 1.2rem;
        }
        .formula-table th:first-child { border-top-left-radius: 10px; }
        .formula-table th:last-child { border-top-right-radius: 10px; }
        
        .formula-table tbody tr {
            transition: background-color 0.3s;
        }
        .formula-table tbody tr:hover {
            background-color: #f7f7f7;
        }
        .formula-table td:nth-child(2) {
            font-family: var(--font-heading);
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--color-danger); /* Color para las fórmulas */
            text-align: center;
        }


        /* ========================================= */
        /* --- 2. HEADER --- */
        /* ========================================= */
        header {
            position: fixed; top: 0; left: 0; width: 100%; height: var(--header-height);
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 3%; 
            background-color: var(--color-surface);
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1); z-index: 1000;
        }
        .logo-container { text-decoration: none; display: flex; align-items: center; }
        .logo-img { height: 35px; margin-right: 10px; content: url('https://i.postimg.cc/t4tVr741/54c82322-2df7-4887-abc0-da706407fcd4-2.png'); } 
        .site-name { font-family: var(--font-heading); font-size: 1.4rem; font-weight: 700; color: var(--color-text-dark); }
        nav ul { list-style: none; display: flex; }
        nav ul li { margin-left: 35px; }
        nav ul li a { text-decoration: none; color: var(--color-text-dark); font-weight: 500; padding: 10px 0; display: block; transition: color 0.3s ease; }
        nav ul li a:hover { color: var(--color-primary); font-weight: 600; border-bottom: 2px solid var(--color-primary); padding-bottom: 8px; }
        
        /* Nuevos Estilos para el Selector de Idioma */
        .header-actions {
            display: flex;
            align-items: center; /* Alineación horizontal de bandera y botón */
        }
        .language-selector {
            position: relative;
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            margin-right: 15px; 
            transition: background-color 0.3s;
        }
        .language-selector:hover {
            background-color: #f0f3f8; /* Efecto hover sutil */
        }
        .current-flag img {
            width: 28px;
            height: 20px;
            border-radius: 3px;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        }
        .language-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: 8px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
            z-index: 1001;
            min-width: 150px;
            display: none;
            padding: 8px 0;
            margin-top: 5px;
        }
        .language-dropdown.active {
            display: block;
        }
        .language-dropdown a {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            text-decoration: none;
            color: var(--color-text-dark);
            font-size: 0.95rem;
        }
        .language-dropdown a:hover {
            background-color: var(--color-background);
        }
        .language-dropdown a img {
            width: 24px;
            height: 18px;
            border-radius: 3px;
            margin-right: 10px;
        }

        .header-actions a.header-button {
            padding: 10px 20px; background-color: var(--color-primary); color: white;
            border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 0.95rem;
            transition: background-color 0.3s, transform 0.2s;
        }
        .header-actions a.header-button:hover { background-color: var(--color-primary-dark); transform: translateY(-1px); }

        /* ========================================= */
        /* --- 3. ESTRUCTURA DINÁMICA DE PASOS --- */
        /* ========================================= */
        .module-wrapper { padding-top: 40px; }
        
        .progress-bar-container {
            width: 100%;
            background-color: var(--color-border);
            border-radius: 5px;
            margin-bottom: 40px;
            height: 12px;
        }
        .progress-bar {
            height: 100%;
            background-color: var(--color-success);
            border-radius: 5px;
            transition: width 0.6s cubic-bezier(0.2, 0.8, 0.2, 1); 
            width: 0%;
        }
        
        .step-content {
            background-color: var(--color-surface);
            padding: 50px;
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
            min-height: 650px; 
            display: none; 
            opacity: 0;
            transform: scale(0.95) translateX(20px); 
            transition: opacity var(--step-transition-duration) ease, transform var(--step-transition-duration) ease;
        }

        .step-content.active {
            display: block;
            opacity: 1;
            transform: scale(1) translateX(0);
        }

        .step-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
        }
        .step-navigation button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Estilo para el Dato Curioso */
        .curious-fact {
            margin-top: 35px;
            padding: 25px;
            background-color: #ecfdf5; /* Color suave de éxito */
            border-radius: 10px;
            font-size: 1rem;
            color: var(--color-text-dark);
            border-left: 5px solid var(--color-success);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            font-weight: 500;
        }
        .curious-fact strong {
            color: var(--color-primary-dark);
        }

        /* Estilos para el código de ejemplo */
        .example-code {
            background-color: #f3f4f6;
            color: var(--color-text-dark);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-family: monospace;
            white-space: pre-wrap;
            border: 1px solid var(--color-border);
            line-height: 1.5;
            font-size: 1.05rem;
        }
        .example-code strong { color: var(--color-primary-dark); }
        .example-code .step-label { color: var(--color-secondary); font-weight: 700; }

        /* Contenedor de Video */
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* Relación 16:9 */
            height: 0;
            overflow: hidden;
            max-width: 100%;
            background: #000;
            margin-bottom: 25px;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .content-image {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 20px auto;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        /* Estilos de la Evaluación Final */
        #quiz-form label {
            display: block;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 25px 0 10px;
            color: var(--color-primary-dark);
        }
        #quiz-form input[type="text"],
        #quiz-form input[type="number"],
        #quiz-form select {
            width: 100%;
            padding: 12px;
            margin-top: 5px;
            border: 2px solid var(--color-border);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        #quiz-form input:focus, #quiz-form select:focus {
            outline: none;
            border-color: var(--color-primary-light);
            box-shadow: 0 0 0 3px rgba(92, 103, 255, 0.2);
        }
        #quiz-form .radio-group, #quiz-form .true-false-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }
        #quiz-form .option-box {
            background-color: var(--color-background);
            padding: 15px 20px;
            border-radius: 8px;
            border: 1px solid var(--color-border);
            cursor: pointer;
            transition: all 0.2s;
            flex-grow: 1;
            text-align: center;
            font-weight: 600;
            color: var(--color-text-dark);
        }
        #quiz-form .option-box:hover {
            background-color: #e5e7eb;
        }
        #quiz-form input[type="radio"] {
            display: none;
        }
        #quiz-form input[type="radio"]:checked + .option-box {
            background-color: var(--color-primary);
            color: white;
            border-color: var(--color-primary-dark);
            box-shadow: 0 3px 8px var(--color-shadow-primary);
        }
        .incorrect-answer { border: 2px solid var(--color-danger) !important; animation: shake 0.5s; }
        .correct-answer { border: 2px solid var(--color-success) !important; }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }

        /* Summary Box */
        #quiz-result-summary {
            margin-top: 30px;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            font-size: 1.5rem;
            font-family: var(--font-heading);
            font-weight: 700;
            display: none;
            transition: opacity 0.5s ease;
        }
        .summary-success { background-color: #ecfdf5; color: var(--color-success); border: 2px solid #a7f3d0; }
        .summary-fail { background-color: #fef2f2; color: var(--color-danger); border: 2px solid #fecaca; }

        /* FOOTER ESTILOS */
        footer {
            background-color: #1a202c; /* Darker background for footer */
            color: #e2e8f0;
            padding: 50px 0 20px 0;
            margin-top: 60px;
        }
        .footer-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }
        .footer-about h5 {
            color: white;
            font-size: 1.4rem;
            margin-bottom: 15px;
            font-family: var(--font-heading);
            font-weight: 700;
        }
        .footer-about p {
            font-size: 0.95rem;
            line-height: 1.8;
            color: #ccc;
        }
        .footer-links h5 {
            font-family: var(--font-heading);
            font-size: 1.1rem;
            margin-bottom: 20px;
            font-weight: 700;
            color: var(--color-secondary);
        }
        .footer-links ul {
            list-style: none;
        }
        .footer-links ul li {
            margin-bottom: 10px;
        }
        .footer-links ul li a {
            color: #ccc;
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.3s;
        }
        .footer-links ul li a:hover {
            color: var(--color-primary-light);
        }
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid #2d3748;
            font-size: 0.8rem;
            color: #a0aec0;
        }
        .footer-about strong {
            color: var(--color-secondary);
        }
        /* Media Queries para Responsive Design */
        @media (max-width: 1024px) {
            h1 { font-size: 2.5rem; }
            h2 { font-size: 2rem; }
            .step-content { padding: 40px; }
            nav { display: none; } /* Ocultar nav en pantallas pequeñas (usar menú hamburguesa) */
        }
        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            h2 { font-size: 1.8rem; }
            .section-title { font-size: 2rem; }
            .section-subtitle { font-size: 1rem; }
            .step-content { padding: 30px; min-height: 500px; }
            .formula-table { width: 100%; font-size: 1rem; }
            .footer-grid { grid-template-columns: 1fr 1fr; }
        }
    </style>
</head>
<body>
    <header>
        <a href="index.html" class="logo-container">
            <img class="logo-img" alt="Educard Logo">
            <span class="site-name">EDUCARD S.A.S.</span>
        </a>
        <nav>
            <ul>
                <li><a href="index.html" data-translate="nav_inicio">Inicio</a></li>
                <li><a href="refuerzos.html" data-translate="nav_refuerzos">Refuerzos</a></li>
                <li><a href="index.html#nosotros" data-translate="nav_nosotros">Nosotros</a></li>
                <li><a href="index.html#beneficios" data-translate="nav_beneficios">Beneficios</a></li>
                <li><a href="faq.html" data-translate="nav_faq">FAQ</a></li>
            </ul>
        </nav>
        <div class="header-actions">
            <div class="language-selector">
                <div class="current-flag">
                    <img id="current-flag-img" src="https://flagcdn.com/co.svg" alt="Colombia Flag" class="flag">
                </div>
                <div class="language-dropdown">
                    <a href="#" data-lang="es"><img src="https://flagcdn.com/co.svg" alt="Bandera Colombia"> Español</a>
                    <a href="#" data-lang="en"><img src="https://flagcdn.com/us.svg" alt="Bandera EE.UU."> English</a>
                    <a href="#" data-lang="de"><img src="https://flagcdn.com/de.svg" alt="Bandera Alemania"> Deutsch</a>
                </div>
            </div>
            <a href="acceder.html" class="header-button" data-translate="acceder_btn">Acceder</a>
        </div>
    </header>

    <main>
        <section class="module-wrapper">
            <div class="container">
                <div class="section-header">
                    <h1 class="section-title" id="moduleTitle"><i class="fa-solid fa-percent"></i> Módulo Proporcionalidad y Porcentajes (P)</h1>
                    <p class="section-subtitle" id="moduleSubtitle">El estudio de la relación de cantidades, las razones y la aplicación de la regla de tres.</p>
                </div>
                
                <div class="progress-bar-container">
                    <div id="progress-bar" class="progress-bar"></div>
                </div>

                <div id="module-content">

                    <div id="step-1" class="step-content"> 
                        <h2><i class="fa-solid fa-arrows-alt-h"></i> 1. Razones y Proporciones: La Igualdad Fundamental</h2>
                        <hr style="margin-top: 15px; border-color: var(--color-border);">

                        <div class="card alert-info">
                            <h3 data-translate="step1_def_header">Definición de Razón y Proporción</h3>
                            <p data-translate="step1_def_text1">Una <strong>Razón</strong> es la comparación de dos cantidades expresada como una división. Se escribe como a/b. Por ejemplo, la razón de 1 a 2 es 1/2.</p>
                            <p data-translate="step1_def_text2">Una <strong>Proporción</strong> es una <strong>igualdad entre dos razones</strong>. Se representa como: a/b = c/d. Esto significa que las cantidades están relacionadas de la misma manera.</p>
                        </div>

                        <div class="card">
                            <h3 data-translate="step1_key_concepts_header">Propiedad Fundamental de las Proporciones</h3>
                            <p data-translate="step1_prop_text">En toda proporción, el producto de los términos externos (extremos) es igual al producto de los términos internos (medios). Esto es conocido como <strong>multiplicación cruzada</strong> o <strong>producto en diagonal</strong>.</p>
                            <div class="example-code">
                                <span class="step-label" data-translate="step1_example_label">Ejemplo:</span> 1/2 = 2/4<br>
                                <strong>Multiplicando en diagonal:</strong><br>
                                1 &times; 4 = 4<br>
                                2 &times; 2 = 4<br>
                                <strong data-translate="step1_prop_check">Como 4 = 4, se cumple la proporción.</strong>
                            </div>
                        </div>
                        
                        <h3 data-translate="step1_video_header">Video Explicativo: ¿Qué son las Proporciones?</h3>
                        <div class="video-container">
                            <iframe width="100%" height="315" src="https://www.youtube.com/embed/8liYyQJ3PIE" title="Video de ¿QUÉ SON LAS PROPORCIONES? Super facil - Para principiantes" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                            <small style="display: block; text-align: center; color: var(--color-text-subtle); margin-top: 10px;" data-translate="step1_video_text">Video: Conceptos básicos de proporción y la prueba de la multiplicación diagonal.</small>
                        </div>

                        <div class="curious-fact">
                            <strong>Dato Curioso:</strong> <span data-translate="step1_curious_fact">La propiedad de la multiplicación cruzada permite resolver problemas de proporcionalidad donde un valor es desconocido (una <strong>incógnita X</strong>), simplemente planteando una igualdad de razones y despejando.</span>
                        </div>
                    </div>

                    <div id="step-2" class="step-content">
                        <h2 data-translate="step2_title"><i class="fa-solid fa-sliders-h"></i> 2. Tipos de Proporcionalidad: Directa e Inversa</h2>
                        <p class="section-subtitle" data-translate="step2_subtitle">Diferenciando cómo se relacionan las cantidades en un problema.</p>
                        <hr style="margin-top: 15px; border-color: var(--color-border);">

                        <div class="card alert-success">
                            <h4 data-translate="step2_direct_header">Proporcionalidad Directa</h4>
                            <p data-translate="step2_direct_text1">Dos cantidades son directamente proporcionales cuando <strong>ambas aumentan o disminuyen al mismo tiempo y a la misma tasa</strong>.</p>
                            <p data-translate="step2_direct_text2">La razón entre ellas (y/x) es siempre la misma, una <strong>constante de proporcionalidad (k)</strong>. Ejemplo: Cuanto más compras, más pagas.</p>
                            <div class="example-code">
                                <span class="step-label" data-translate="step2_formula_label">Fórmula:</span> y = k &times; x
                            </div>
                        </div>

                        <div class="card alert-warning">
                            <h4 data-translate="step2_inverse_header">Proporcionalidad Inversa</h4>
                            <p data-translate="step2_inverse_text1">Dos cantidades son inversamente proporcionales cuando <strong>una aumenta y la otra disminuye en la misma proporción</strong> (y viceversa).</p>
                            <p data-translate="step2_inverse_text2">El producto entre ellas (x &times; y) es siempre una <strong>constante (k)</strong>. Ejemplo: Cuantos más trabajadores, menos tiempo tardan en hacer una obra.</p>
                            <div class="example-code">
                                <span class="step-label" data-translate="step2_formula_label_inv">Fórmula:</span> y = k / x
                            </div>
                        </div>

                        <div class="curious-fact">
                            <strong>Dato Curioso:</strong> <span data-translate="step2_curious_fact">La **Regla de Tres** es el método más común para resolver problemas de proporcionalidad, ya que permite encontrar un cuarto valor desconocido a partir de tres valores conocidos, usando la igualdad de razones.</span>
                        </div>
                    </div>

                    <div id="step-3" class="step-content">
                        <h2 data-translate="step3_title"><i class="fa-solid fa-percentage"></i> 3. Los Porcentajes: Razón de Cien</h2>
                        <p class="section-subtitle" data-translate="step3_subtitle">Cómo representar una porción como una fracción de 100 y su aplicación.</p>
                        <hr style="margin-top: 15px; border-color: var(--color-border);">
                        
                        <div class="card">
                            <h4 data-translate="step3_def_header">Definición y Equivalencias</h4>
                            <p data-translate="step3_def_text">Un <strong>Porcentaje (%)</strong> es una forma de expresar una razón o una fracción en la que el denominador es 100. Literalmente significa "por cada cien".</p>
                            
                            <table class="formula-table">
                                <thead>
                                    <tr>
                                        <th data-translate="step3_table_header_perc">Porcentaje</th>
                                        <th data-translate="step3_table_header_frac">Fracción</th>
                                        <th data-translate="step3_table_header_dec">Decimal</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>50%</td>
                                        <td>50 / 100 = 1/2</td>
                                        <td>0.50</td>
                                    </tr>
                                    <tr>
                                        <td>25%</td>
                                        <td>25 / 100 = 1/4</td>
                                        <td>0.25</td>
                                    </tr>
                                    <tr>
                                        <td>10%</td>
                                        <td>10 / 100 = 1/10</td>
                                        <td>0.10</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="card alert-success">
                            <h4 data-translate="step3_calc_header">Cálculo Básico de Porcentajes</h4>
                            <p data-translate="step3_calc_text">Para calcular el porcentaje de una cantidad, siempre se usa el <strong>equivalente decimal</strong> del porcentaje y se multiplica por la cantidad total.</p>
                            <div class="example-code">
                                <span class="step-label" data-translate="step3_calc_example_q">Problema:</span> ¿Cuál es el <strong>20% de 300</strong>?<br>
                                <span class="step-label" data-translate="step3_calc_example_op">Operación:</span> 20% = 0.20<br>
                                0.20 &times; 300 = <strong>60</strong>
                            </div>
                        </div>
                        
                        <div class="curious-fact">
                            <strong>Dato Curioso:</strong> <span data-translate="step3_curious_fact">Los porcentajes son esenciales en la economía diaria, siendo la base para calcular <strong>descuentos</strong>, <strong>impuestos (IVA)</strong>, <strong>intereses bancarios</strong> y la composición nutricional de los alimentos.</span>
                        </div>
                    </div>

                    <div id="step-4" class="step-content">
                        <h2 data-translate="step4_title"><i class="fa-solid fa-balance-scale"></i> 4. Aplicaciones con la Regla de Tres</h2>
                        <p class="section-subtitle" data-translate="step4_subtitle">El método universal para resolver problemas de proporcionalidad directa e inversa.</p>
                        <hr style="margin-top: 15px; border-color: var(--color-border);">
                        
                        <div class="card alert-info">
                            <h4 data-translate="step4_direct_rule_header">Regla de Tres Simple Directa</h4>
                            <p data-translate="step4_direct_rule_text1">Se usa cuando la proporcionalidad es directa. Se multiplican los valores en diagonal (la que no incluye la X) y se divide por el valor restante (el que está en diagonal con la X).</p>
                            <div class="example-code">
                                <span class="step-label" data-translate="step4_example_direct_q">Problema:</span> 3 kg de papas cuestan $6.000. ¿Cuánto cuestan 5 kg?<br>
                                <strong>Planteamiento:</strong><br>
                                3 kg &rarr; $6.000<br>
                                5 kg &rarr; X<br>
                                <strong>Solución:</strong> X = (5 &times; 6.000) / 3 = <strong>$10.000</strong>
                            </div>
                        </div>

                        <div class="card alert-danger">
                            <h4 data-translate="step4_inverse_rule_header">Regla de Tres Simple Inversa</h4>
                            <p data-translate="step4_inverse_rule_text1">Se usa cuando la proporcionalidad es inversa. Se multiplican los valores de la misma línea (la que no incluye la X) y se divide por el valor restante.</p>
                            <p data-translate="step4_inverse_rule_text2">Recuerda: <strong>Si una cantidad sube, la otra baja.</strong></p>
                            <div class="example-code">
                                <span class="step-label" data-translate="step4_example_inverse_q">Problema:</span> 4 obreros tardan 6 horas en pintar una casa. ¿Cuánto tardarán 8 obreros?<br>
                                <strong>Planteamiento:</strong><br>
                                4 obreros &rarr; 6 horas<br>
                                8 obreros &rarr; X<br>
                                <strong>Solución:</strong> X = (4 &times; 6) / 8 = 24 / 8 = <strong>3 horas</strong>
                            </div>
                        </div>

                        <div class="curious-fact">
                            <strong>Dato Curioso:</strong> <span data-translate="step4_curious_fact">El ejercicio de los pasteles y los huevos que se resuelve en el video [00:03:01] es un ejemplo de <strong>Regla de Tres Directa</strong>, demostrando cómo se usa la propiedad fundamental de las proporciones (multiplicación cruzada) para encontrar el valor desconocido.</span>
                        </div>
                    </div>

                    <div id="step-5" class="step-content">
                        <h2 data-translate="step5_title"><i class="fa-solid fa-graduation-cap"></i> 5. Evaluación Final: ¡Mide tu Conocimiento!</h2>
                        <p class="section-subtitle" data-translate="step5_subtitle">Responde el siguiente Quiz de 5 preguntas para validar tu aprendizaje sobre Proporcionalidad y Porcentajes.</p>
                        <hr style="margin-top: 15px; border-color: var(--color-border);">

                        <form id="quiz-form">
                            <div id="question1">
                                <label for="q1_input" data-translate="step5_q1_label">¿Qué se define como una "igualdad entre dos razones"?</label>
                                <input type="text" id="q1_input" name="question1" required>
                            </div>

                            <div id="question2">
                                <label for="q2_input" data-translate="step5_q2_label">Si 4 es a 8 como X es a 16, ¿cuánto vale X?</label>
                                <input type="number" id="q2_input" name="question2" required>
                            </div>

                            <div id="question3">
                                <label for="q3_op1" data-translate="step5_q3_label">¿Qué tipo de proporcionalidad se aplica cuando la velocidad aumenta y el tiempo de viaje disminuye?</label>
                                <div class="radio-group">
                                    <input type="radio" id="q3_op1" name="question3" value="directa">
                                    <label for="q3_op1" class="option-box" data-translate="step5_q3_op1">Proporcionalidad Directa</label>
                                    <input type="radio" id="q3_op2" name="question3" value="inversa">
                                    <label for="q3_op2" class="option-box" data-translate="step5_q3_op2">Proporcionalidad Inversa</label>
                                    <input type="radio" id="q3_op3" name="question3" value="compuesta">
                                    <label for="q3_op3" class="option-box" data-translate="step5_q3_op3">Regla de Tres Compuesta</label>
                                    <input type="radio" id="q3_op4" name="question3" value="razon">
                                    <label for="q3_op4" class="option-box" data-translate="step5_q3_op4">Solo una Razón</label>
                                </div>
                            </div>

                            <div id="question4">
                                <label for="q4_true" data-translate="step5_q4_label">Verdadero o Falso: El 25% de la cantidad 80 es igual a 20.</label>
                                <div class="true-false-group">
                                    <input type="radio" id="q4_true" name="question4" value="true" required>
                                    <label for="q4_true" class="option-box" data-translate="step5_q4_op1">Verdadero</label>
                                    <input type="radio" id="q4_false" name="question4" value="false">
                                    <label for="q4_false" class="option-box" data-translate="step5_q4_op2">Falso</label>
                                </div>
                            </div>

                            <div id="question5">
                                <label for="q5_input" data-translate="step5_q5_label">Si 50 es el 100% de una cantidad, ¿cuál es el 50% de esa misma cantidad?</label>
                                <input type="number" id="q5_input" name="question5" required>
                            </div>

                            <div id="quiz-result-summary" class=""> </div>
                            <button type="submit" class="btn btn-primary" style="margin-top: 30px;" data-translate="step5_submit_btn">
                                <i class="fa-solid fa-clipboard-check"></i> Evaluar Respuestas
                            </button>
                        </form>
                    </div>

                </div>

                <div class="step-navigation">
                    <button id="prev-btn" class="btn btn-outline" disabled><i class="fa-solid fa-arrow-left"></i> Anterior</button>
                    <button id="next-btn" class="btn btn-primary">Siguiente <i class="fa-solid fa-arrow-right"></i></button>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-about">
                    <h5>EDUCARD S.A.S.</h5>
                    <p>Somos una empresa dedicada a fortalecer las competencias académicas en matemáticas y tecnología, ofreciendo módulos interactivos y personalizados para el crecimiento de los estudiantes.</p>
                    <p data-translate="footer_made_with"><strong>Hecho con <i class="fa-solid fa-heart" style="color: #ef4444;"></i> en Cajicá, Cundinamarca.</strong></p>
                </div>
                <div class="footer-links">
                    <h5>Productos</h5>
                    <ul>
                        <li><a href="#">Módulos de Refuerzo</a></li>
                        <li><a href="#">Simulacros Saber</a></li>
                        <li><a href="#">Tutorías Personalizadas</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h5>Compañía</h5>
                    <ul>
                        <li><a href="#">Acerca de Nosotros</a></li>
                        <li><a href="#">Política de Privacidad</a></li>
                        <li><a href="#">Términos y Condiciones</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h5>Soporte</h5>
                    <ul>
                        <li><a href="faq.html">FAQ</a></li>
                        <li><a href="mailto:contacto@educard.co">Contacto por Email</a></li>
                        <li><a href="tel:+573001234567">Llamar (300 123 4567)</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                &copy; 2024 EDUCARD S.A.S. Todos los derechos reservados.
            </div>
        </div>
    </footer>

    <script>
        // =========================================
        // --- LÓGICA DEL MÓDULO INTERACTIVO ---
        // =========================================

        document.addEventListener('DOMContentLoaded', () => {

            // --- 1. LÓGICA DE TRADUCCIÓN (Contenido para el Módulo 4: Proporcionalidad y Porcentajes) ---

            const languageData = {
                es: {
                    nav_inicio: "Inicio", nav_refuerzos: "Refuerzos", nav_nosotros: "Nosotros", nav_beneficios: "Beneficios", nav_faq: "FAQ", acceder_btn: "Acceder", 
                    
                    // Step 1
                    step1_def_header: "Definición de Razón y Proporción",
                    step1_def_text1: "Una <strong>Razón</strong> es la comparación de dos cantidades expresada como una división. Se escribe como a/b. Por ejemplo, la razón de 1 a 2 es 1/2.",
                    step1_def_text2: "Una <strong>Proporción</strong> es una <strong>igualdad entre dos razones</strong>. Se representa como: a/b = c/d. Esto significa que las cantidades están relacionadas de la misma manera.",
                    step1_key_concepts_header: "Propiedad Fundamental de las Proporciones",
                    step1_prop_text: "En toda proporción, el producto de los términos externos (extremos) es igual al producto de los términos internos (medios). Esto es conocido como <strong>multiplicación cruzada</strong> o <strong>producto en diagonal</strong>.",
                    step1_example_label: "Ejemplo:",
                    step1_prop_check: "Como 4 = 4, se cumple la proporción.",
                    step1_video_header: "Video Explicativo: ¿Qué son las Proporciones?",
                    step1_video_text: "Video: Conceptos básicos de proporción y la prueba de la multiplicación diagonal.",
                    step1_curious_fact: "La propiedad de la multiplicación cruzada permite resolver problemas de proporcionalidad donde un valor es desconocido (una <strong>incógnita X</strong>), simplemente planteando una igualdad de razones y despejando.",
                    
                    // Step 2
                    step2_title: "2. Tipos de Proporcionalidad: Directa e Inversa",
                    step2_subtitle: "Diferenciando cómo se relacionan las cantidades en un problema.",
                    step2_direct_header: "Proporcionalidad Directa",
                    step2_direct_text1: "Dos cantidades son directamente proporcionales cuando <strong>ambas aumentan o disminuyen al mismo tiempo y a la misma tasa</strong>.",
                    step2_direct_text2: "La razón entre ellas (y/x) es siempre la misma, una <strong>constante de proporcionalidad (k)</strong>. Ejemplo: Cuanto más compras, más pagas.",
                    step2_formula_label: "Fórmula:",
                    step2_inverse_header: "Proporcionalidad Inversa",
                    step2_inverse_text1: "Dos cantidades son inversamente proporcionales cuando <strong>una aumenta y la otra disminuye en la misma proporción</strong> (y viceversa).",
                    step2_inverse_text2: "El producto entre ellas (x &times; y) es siempre una <strong>constante (k)</strong>. Ejemplo: Cuantos más trabajadores, menos tiempo tardan en hacer una obra.",
                    step2_formula_label_inv: "Fórmula:",
                    step2_curious_fact: "La <strong>Regla de Tres</strong> es el método más común para resolver problemas de proporcionalidad, ya que permite encontrar un cuarto valor desconocido a partir de tres valores conocidos, usando la igualdad de razones.",
                    
                    // Step 3 
                    step3_title: "3. Los Porcentajes: Razón de Cien",
                    step3_subtitle: "Cómo representar una porción como una fracción de 100 y su aplicación.",
                    step3_def_header: "Definición y Equivalencias",
                    step3_def_text: "Un <strong>Porcentaje (%)</strong> es una forma de expresar una razón o una fracción en la que el denominador es 100. Literalmente significa \"por cada cien\".",
                    step3_table_header_perc: "Porcentaje",
                    step3_table_header_frac: "Fracción",
                    step3_table_header_dec: "Decimal",
                    step3_calc_header: "Cálculo Básico de Porcentajes",
                    step3_calc_text: "Para calcular el porcentaje de una cantidad, siempre se usa el <strong>equivalente decimal</strong> del porcentaje y se multiplica por la cantidad total.",
                    step3_calc_example_q: "Problema:",
                    step3_calc_example_op: "Operación:",
                    step3_curious_fact: "Los porcentajes son esenciales en la economía diaria, siendo la base para calcular <strong>descuentos</strong>, <strong>impuestos (IVA)</strong>, <strong>intereses bancarios</strong> y la composición nutricional de los alimentos.",

                    // Step 4 
                    step4_title: "4. Aplicaciones con la Regla de Tres",
                    step4_subtitle: "El método universal para resolver problemas de proporcionalidad directa e inversa.",
                    step4_direct_rule_header: "Regla de Tres Simple Directa",
                    step4_direct_rule_text1: "Se usa cuando la proporcionalidad es directa. Se multiplican los valores en diagonal (la que no incluye la X) y se divide por el valor restante (el que está en diagonal con la X).",
                    step4_example_direct_q: "Problema:",
                    step4_inverse_rule_header: "Regla de Tres Simple Inversa",
                    step4_inverse_rule_text1: "Se usa cuando la proporcionalidad es inversa. Se multiplican los valores de la misma línea (la que no incluye la X) y se divide por el valor restante.",
                    step4_inverse_rule_text2: "Recuerda: <strong>Si una cantidad sube, la otra baja.</strong>",
                    step4_example_inverse_q: "Problema:",
                    step4_curious_fact: "El ejercicio de los pasteles y los huevos que se resuelve en el video [00:03:01] es un ejemplo de <strong>Regla de Tres Directa</strong>, demostrando cómo se usa la propiedad fundamental de las proporciones (multiplicación cruzada) para encontrar el valor desconocido.",

                    // Step 5
                    step5_title: "5. Evaluación Final: ¡Mide tu Conocimiento!",
                    step5_subtitle: "Responde el siguiente Quiz de 5 preguntas para validar tu aprendizaje sobre Proporcionalidad y Porcentajes.",
                    step5_q1_label: "¿Qué se define como una \"igualdad entre dos razones\"?",
                    step5_q2_label: "Si 4 es a 8 como X es a 16, ¿cuánto vale X?",
                    step5_q3_label: "¿Qué tipo de proporcionalidad se aplica cuando la velocidad aumenta y el tiempo de viaje disminuye?",
                    step5_q3_op1: "Proporcionalidad Directa", step5_q3_op2: "Proporcionalidad Inversa", step5_q3_op3: "Regla de Tres Compuesta", step5_q3_op4: "Solo una Razón",
                    step5_q4_label: "Verdadero o Falso: El 25% de la cantidad 80 es igual a 20.",
                    step5_q4_op1: "Verdadero", step5_q4_op2: "Falso",
                    step5_q5_label: "Si 50 es el 100% de una cantidad, ¿cuál es el 50% de esa misma cantidad?",
                    step5_submit_btn: "Evaluar Respuestas",
                    
                    // Quiz Feedback
                    quiz_feedback_perfect: `<i class="fa-solid fa-star"></i> ¡DOMINIO TOTAL! {score} de {total} correctas. Eres un maestro de la Proporcionalidad.`,
                    quiz_feedback_good: `<i class="fa-solid fa-thumbs-up"></i> ¡Muy Bien! {score} de {total} correctas. Revisa los errores marcados para refuerzo.`,
                    quiz_feedback_poor: `<i class="fa-solid fa-frown"></i> Resultado: {score} de {total} correctas. Regresa a la sección de Teoría, ¡aún queda trabajo por hacer!`,

                    // Footer
                    footer_made_with: "<strong>Hecho con <i class=\"fa-solid fa-heart\" style=\"color: #ef4444;\"></i> en Cajicá, Cundinamarca.</strong>"
                },
                // --- TRADUCCIONES EN INGLÉS ---
                en: {
                    nav_inicio: "Home", nav_refuerzos: "Reinforcements", nav_nosotros: "About Us", nav_beneficios: "Benefits", nav_faq: "FAQ", acceder_btn: "Access", 
                    
                    // Step 1
                    step1_def_header: "Definition of Ratio and Proportion",
                    step1_def_text1: "A <strong>Ratio</strong> is the comparison of two quantities expressed as a division. It is written as a/b. For example, the ratio of 1 to 2 is 1/2.",
                    step1_def_text2: "A <strong>Proportion</strong> is an <strong>equality between two ratios</strong>. It is represented as: a/b = c/d. This means the quantities are related in the same way.",
                    step1_key_concepts_header: "Fundamental Property of Proportions",
                    step1_prop_text: "In any proportion, the product of the outer terms (extremes) is equal to the product of the inner terms (means). This is known as <strong>cross-multiplication</strong> or <strong>diagonal product</strong>.",
                    step1_example_label: "Example:",
                    step1_prop_check: "Since 4 = 4, the proportion is valid.",
                    step1_video_header: "Explanatory Video: What are Proportions?",
                    step1_video_text: "Video: Basic concepts of proportion and the diagonal multiplication test.",
                    step1_curious_fact: "The cross-multiplication property allows solving proportionality problems where one value is unknown (an <strong>unknown X</strong>), simply by setting up an equality of ratios and solving for X.",
                    
                    // Step 2
                    step2_title: "2. Types of Proportionality: Direct and Inverse",
                    step2_subtitle: "Differentiating how quantities relate in a problem.",
                    step2_direct_header: "Direct Proportionality",
                    step2_direct_text1: "Two quantities are directly proportional when <strong>both increase or decrease simultaneously and at the same rate</strong>.",
                    step2_direct_text2: "The ratio between them (y/x) is always the same, a <strong>constant of proportionality (k)</strong>. Example: The more you buy, the more you pay.",
                    step2_formula_label: "Formula:",
                    step2_inverse_header: "Inverse Proportionality",
                    step2_inverse_text1: "Two quantities are inversely proportional when <strong>one increases and the other decreases in the same proportion</strong> (and vice versa).",
                    step2_inverse_text2: "The product between them (x &times; y) is always a <strong>constant (k)</strong>. Example: More workers, less time to complete a job.",
                    step2_formula_label_inv: "Formula:",
                    step2_curious_fact: "The <strong>Rule of Three</strong> is the most common method for solving proportionality problems, as it allows finding a fourth unknown value from three known values, using the equality of ratios.",

                    // Step 3 
                    step3_title: "3. Percentages: Ratio of One Hundred",
                    step3_subtitle: "How to represent a portion as a fraction of 100 and its application.",
                    step3_def_header: "Definition and Equivalences",
                    step3_def_text: "A <strong>Percentage (%)</strong> is a way of expressing a ratio or a fraction where the denominator is 100. It literally means \"per cent\".",
                    step3_table_header_perc: "Percentage",
                    step3_table_header_frac: "Fraction",
                    step3_table_header_dec: "Decimal",
                    step3_calc_header: "Basic Percentage Calculation",
                    step3_calc_text: "To calculate the percentage of a quantity, always use the <strong>decimal equivalent</strong> of the percentage and multiply it by the total quantity.",
                    step3_calc_example_q: "Problem:",
                    step3_calc_example_op: "Operation:",
                    step3_curious_fact: "Percentages are essential in daily economics, forming the basis for calculating <strong>discounts</strong>, <strong>taxes (VAT)</strong>, <strong>bank interest</strong>, and the nutritional composition of food.",

                    // Step 4 
                    step4_title: "4. Applications with the Rule of Three",
                    step4_subtitle: "The universal method for solving direct and inverse proportionality problems.",
                    step4_direct_rule_header: "Simple Direct Rule of Three",
                    step4_direct_rule_text1: "Used when proportionality is direct. Multiply the values diagonally (the pair that does not include X) and divide by the remaining value (the one diagonal to X).",
                    step4_example_direct_q: "Problem:",
                    step4_inverse_rule_header: "Simple Inverse Rule of Three",
                    step4_inverse_rule_text1: "Used when proportionality is inverse. Multiply the values on the same line (the pair that does not include X) and divide by the remaining value.",
                    step4_inverse_rule_text2: "Remember: <strong>If one quantity goes up, the other goes down.</strong>",
                    step4_example_inverse_q: "Problem:",
                    step4_curious_fact: "The cake and egg problem solved in the video [00:03:01] is an example of the <strong>Simple Direct Rule of Three</strong>, demonstrating how the fundamental property of proportions (cross-multiplication) is used to find the unknown value.",

                    // Step 5
                    step5_title: "5. Final Evaluation: Measure Your Knowledge!",
                    step5_subtitle: "Answer the following 5-question Quiz to validate your learning about Proportionality and Percentages.",
                    step5_q1_label: "What is defined as an \"equality between two ratios\"?",
                    step5_q2_label: "If 4 is to 8 as X is to 16, what is the value of X?",
                    step5_q3_label: "What type of proportionality applies when speed increases and travel time decreases?",
                    step5_q3_op1: "Direct Proportionality", step5_q3_op2: "Inverse Proportionality", step5_q3_op3: "Compound Rule of Three", step5_q3_op4: "Only a Ratio",
                    step5_q4_label: "True or False: 25% of the quantity 80 is equal to 20.",
                    step5_q4_op1: "True", step5_q4_op2: "False",
                    step5_q5_label: "If 50 is 100% of a quantity, what is 50% of that same quantity?",
                    step5_submit_btn: "Evaluate Answers",
                    
                    // Quiz Feedback
                    quiz_feedback_perfect: `<i class="fa-solid fa-star"></i> TOTAL DOMINATION! {score} out of {total} correct. You are a Proportionality Master.`,
                    quiz_feedback_good: `<i class="fa-solid fa-thumbs-up"></i> Very Good! {score} out of {total} correct. Review the marked errors for reinforcement.`,
                    quiz_feedback_poor: `<i class="fa-solid fa-frown"></i> Result: {score} out of {total} correct. Go back to the Theory section, there is still work to be done!`,

                    // Footer
                    footer_made_with: "<strong>Made with <i class=\"fa-solid fa-heart\" style=\"color: #ef4444;\"></i> in Cajicá, Cundinamarca.</strong>"
                },
                // --- TRADUCCIONES EN ALEMÁN ---
                de: {
                    nav_inicio: "Startseite", nav_refuerzos: "Nachhilfe", nav_nosotros: "Über Uns", nav_beneficios: "Vorteile", nav_faq: "FAQ", acceder_btn: "Zugang", 
                    
                    // Step 1
                    step1_def_header: "Definition von Verhältnis und Proportion",
                    step1_def_text1: "Ein <strong>Verhältnis (Razón)</strong> ist der Vergleich zweier Größen, ausgedrückt als Division. Es wird als a/b geschrieben. Zum Beispiel ist das Verhältnis von 1 zu 2 gleich 1/2.",
                    step1_def_text2: "Eine <strong>Proportion</strong> ist eine <strong>Gleichheit zwischen zwei Verhältnissen</strong>. Sie wird dargestellt als: a/b = c/d. Dies bedeutet, dass die Größen in gleicher Weise miteinander in Beziehung stehen.",
                    step1_key_concepts_header: "Grundlegende Eigenschaft von Proportionen",
                    step1_prop_text: "Bei jeder Proportion ist das Produkt der äußeren Glieder (Extreme) gleich dem Produkt der inneren Glieder (Mittel). Dies ist als <strong>Kreuzmultiplikation</strong> oder <strong>Diagonalprodukt</strong> bekannt.",
                    step1_example_label: "Beispiel:",
                    step1_prop_check: "Da 4 = 4 ist, ist die Proportion erfüllt.",
                    step1_video_header: "Erklärvideo: Was sind Proportionen?",
                    step1_video_text: "Video: Grundlegende Konzepte der Proportion und der Test der Diagonalmultiplikation.",
                    step1_curious_fact: "Die Eigenschaft der Kreuzmultiplikation ermöglicht die Lösung von Proportionalitätsproblemen, bei denen ein Wert unbekannt ist (eine <strong>Unbekannte X</strong>), indem einfach eine Gleichheit von Verhältnissen aufgestellt und nach X aufgelöst wird.",
                    
                    // Step 2
                    step2_title: "2. Arten der Proportionalität: Direkt und Invers",
                    step2_subtitle: "Unterscheidung, wie Größen in einem Problem miteinander in Beziehung stehen.",
                    step2_direct_header: "Direkte Proportionalität",
                    step2_direct_text1: "Zwei Größen sind direkt proportional, wenn <strong>beide gleichzeitig und mit der gleichen Rate zu- oder abnehmen</strong>.",
                    step2_direct_text2: "Das Verhältnis zwischen ihnen (y/x) ist immer gleich, eine <strong>Proportionalitätskonstante (k)</strong>. Beispiel: Je mehr Sie kaufen, desto mehr bezahlen Sie.",
                    step2_formula_label: "Formel:",
                    step2_inverse_header: "Inverse Proportionalität",
                    step2_inverse_text1: "Zwei Größen sind invers proportional, wenn <strong>die eine zunimmt und die andere im gleichen Verhältnis abnimmt</strong> (und umgekehrt).",
                    step2_inverse_text2: "Das Produkt zwischen ihnen (x &times; y) ist immer eine <strong>Konstante (k)</strong>. Beispiel: Mehr Arbeiter, weniger Zeit für eine Arbeit.",
                    step2_formula_label_inv: "Formel:",
                    step2_curious_fact: "Die <strong>Dreisatzrechnung</strong> ist die gängigste Methode zur Lösung von Proportionalitätsproblemen, da sie es ermöglicht, einen vierten unbekannten Wert aus drei bekannten Werten zu finden, indem die Gleichheit der Verhältnisse genutzt wird.",

                    // Step 3 
                    step3_title: "3. Prozentsätze: Verhältnis von Hundert",
                    step3_subtitle: "Wie man einen Anteil als Bruchteil von 100 darstellt und seine Anwendung.",
                    step3_def_header: "Definition und Entsprechungen",
                    step3_def_text: "Ein <strong>Prozentsatz (%)</strong> ist eine Möglichkeit, ein Verhältnis oder einen Bruch auszudrücken, bei dem der Nenner 100 ist. Es bedeutet wörtlich \"pro Hundert\".",
                    step3_table_header_perc: "Prozentsatz",
                    step3_table_header_frac: "Bruch",
                    step3_table_header_dec: "Dezimal",
                    step3_calc_header: "Grundlegende Prozentrechnung",
                    step3_calc_text: "Um den Prozentsatz einer Größe zu berechnen, verwendet man immer den <strong>Dezimalwert</strong> des Prozentsatzes und multipliziert ihn mit der Gesamtmenge.",
                    step3_calc_example_q: "Problem:",
                    step3_calc_example_op: "Rechenweg:",
                    step3_curious_fact: "Prozentsätze sind im täglichen Wirtschaftsleben unerlässlich. Sie sind die Grundlage für die Berechnung von <strong>Rabatten</strong>, <strong>Steuern (MwSt.)</strong>, <strong>Bankzinsen</strong> und der Nährwertzusammensetzung von Lebensmitteln.",

                    // Step 4 
                    step4_title: "4. Anwendungen mit dem Dreisatz",
                    step4_subtitle: "Die universelle Methode zur Lösung von direkten und inversen Proportionalitätsproblemen.",
                    step4_direct_rule_header: "Einfacher Dreisatz (Direkt)",
                    step4_direct_rule_text1: "Wird verwendet, wenn die Proportionalität direkt ist. Man multipliziert die Werte diagonal (das Paar, das nicht X enthält) und teilt durch den verbleibenden Wert (der diagonal zu X liegt).",
                    step4_example_direct_q: "Problem:",
                    step4_inverse_rule_header: "Einfacher Dreisatz (Invers)",
                    step4_inverse_rule_text1: "Wird verwendet, wenn die Proportionalität invers ist. Man multipliziert die Werte in derselben Zeile (das Paar, das nicht X enthält) und teilt durch den verbleibenden Wert.",
                    step4_inverse_rule_text2: "Denken Sie daran: <strong>Wenn eine Größe steigt, sinkt die andere.</strong>",
                    step4_example_inverse_q: "Problem:",
                    step4_curious_fact: "Die im Video [00:03:01] gelöste Aufgabe mit Kuchen und Eiern ist ein Beispiel für den <strong>Einfachen Dreisatz (Direkt)</strong> und zeigt, wie die grundlegende Eigenschaft von Proportionen (Kreuzmultiplikation) verwendet wird, um den unbekannten Wert zu finden.",

                    // Step 5
                    step5_title: "5. Abschlussbewertung: Messen Sie Ihr Wissen!",
                    step5_subtitle: "Beantworten Sie das folgende 5-Fragen-Quiz, um Ihr Wissen über Proportionalität und Prozentsätze zu überprüfen.",
                    step5_q1_label: "Was wird als eine \"Gleichheit zwischen zwei Verhältnissen\" definiert?",
                    step5_q2_label: "Wenn 4 zu 8 steht wie X zu 16, welchen Wert hat X?",
                    step5_q3_label: "Welche Art von Proportionalität liegt vor, wenn die Geschwindigkeit zunimmt und die Reisezeit abnimmt?",
                    step5_q3_op1: "Direkte Proportionalität", step5_q3_op2: "Inverse Proportionalität", step5_q3_op3: "Zusammengesetzter Dreisatz", step5_q3_op4: "Nur ein Verhältnis",
                    step5_q4_label: "Wahr oder Falsch: 25% der Menge 80 entsprechen 20.",
                    step5_q4_op1: "Wahr", step5_q4_op2: "Falsch",
                    step5_q5_label: "Wenn 50 100% einer Menge ist, was sind dann 50% dieser Menge?",
                    step5_submit_btn: "Antworten Auswerten",
                    
                    // Quiz Feedback
                    quiz_feedback_perfect: `<i class="fa-solid fa-star"></i> TOTALE BEHERRSCHUNG! {score} von {total} richtig. Sie sind ein Proportionalitätsmeister.`,
                    quiz_feedback_good: `<i class="fa-solid fa-thumbs-up"></i> Sehr Gut! {score} von {total} richtig. Überprüfen Sie die markierten Fehler zur Vertiefung.`,
                    quiz_feedback_poor: `<i class="fa-solid fa-frown"></i> Ergebnis: {score} von {total} richtig. Gehen Sie zurück zum Theorieabschnitt, es gibt noch Arbeit zu erledigen!`,

                    // Footer
                    footer_made_with: "<strong>Mit <i class=\"fa-solid fa-heart\" style=\"color: #ef4444;\"></i> in Cajicá, Cundinamarca, erstellt.</strong>"
                }
            }; 

            function applyTranslation(lang) {
                const translations = languageData[lang];
                if (!translations) return;

                document.getElementById('pageTitle').textContent = lang === 'es' 
                    ? "Módulo Cuatro | EDUCARD SAS" 
                    : lang === 'en' 
                    ? "Dynamic Module: Proportionality and Percentages (P) | EDUCARD SAS"
                    : "Dynamisches Modul: Proportionalität und Prozentsätze (P) | EDUCARD SAS";

                document.getElementById('moduleTitle').innerHTML = lang === 'es' 
                    ? '<i class="fa-solid fa-percent"></i> Módulo Proporcionalidad y Porcentajes (P)'
                    : lang === 'en'
                    ? '<i class="fa-solid fa-percent"></i> Proportionality and Percentages Module (P)'
                    : '<i class="fa-solid fa-percent"></i> Modul Proportionalität und Prozentsätze (P)';
                
                document.getElementById('moduleSubtitle').textContent = lang === 'es'
                    ? "El estudio de la relación de cantidades, las razones y la aplicación de la regla de tres."
                    : lang === 'en'
                    ? "The study of the relationship of quantities, ratios, and the application of the rule of three."
                    : "Die Untersuchung der Beziehung von Mengen, Verhältnissen und der Anwendung der Dreisatzregel.";


                document.querySelectorAll('[data-translate]').forEach(element => {
                    const key = element.dataset.translate;
                    if (translations[key]) {
                        element.innerHTML = translations[key]; 
                    }
                });
                
                // Actualizar la bandera (simulación)
                const flagImg = document.getElementById('current-flag-img');
                if (lang === 'es') flagImg.src = 'https://flagcdn.com/co.svg';
                else if (lang === 'en') flagImg.src = 'https://flagcdn.com/us.svg';
                else if (lang === 'de') flagImg.src = 'https://flagcdn.com/de.svg';
            }

            // 2. Lógica de Navegación (Copiada de modulo1.html)
            const steps = [
                document.getElementById('step-1'),
                document.getElementById('step-2'),
                document.getElementById('step-3'),
                document.getElementById('step-4'),
                document.getElementById('step-5')
            ];
            const totalSteps = steps.length;
            let currentStep = 0;
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const progressBar = document.getElementById('progress-bar');
            
            // Manejar el clic fuera del dropdown para cerrarlo
            document.body.addEventListener('click', (e) => {
                if (!e.target.closest('.language-selector')) {
                    document.querySelectorAll('.language-dropdown').forEach(d => d.classList.remove('active'));
                }
            });

            // Lógica para mostrar/ocultar pasos y actualizar la barra
            function showStep(stepIndex) {
                // Validación para evitar pasos fuera de rango
                if (stepIndex < 0 || stepIndex >= totalSteps) return;

                // Ocultar todos los pasos y remover la clase 'active'
                steps.forEach((step, index) => {
                    if (index === currentStep && index !== stepIndex) {
                         // Transición de salida
                        step.style.opacity = '0';
                        step.style.transform = stepIndex > currentStep ? 'scale(0.95) translateX(-20px)' : 'scale(0.95) translateX(20px)';
                        setTimeout(() => {
                            step.classList.remove('active');
                            
                            // Transición de entrada del nuevo paso
                            currentStep = stepIndex;
                            const newStep = steps[currentStep];
                            newStep.classList.add('active');
                            newStep.style.opacity = '1';
                            newStep.style.transform = 'scale(1) translateX(0)';
                            updateNavigation();
                        }, 600); // Duración de la animación
                    } else if (index === stepIndex && index === currentStep) {
                        // Si es el primer paso o si el índice no ha cambiado, solo actualiza la navegación
                        steps[stepIndex].classList.add('active');
                        steps[stepIndex].style.opacity = '1';
                        steps[stepIndex].style.transform = 'scale(1) translateX(0)';
                        currentStep = stepIndex;
                        updateNavigation();
                    }
                });

                if (currentStep !== stepIndex) {
                     // Solo si el paso es realmente diferente (para evitar la doble animación)
                    currentStep = stepIndex;
                    updateNavigation();
                }
               
            }

            function updateNavigation() {
                prevBtn.disabled = currentStep === 0;
                // El botón Siguiente se deshabilita en el paso final (que es el quiz)
                nextBtn.disabled = currentStep === totalSteps - 1; 

                // Actualizar la barra de progreso. El progreso está basado en el paso que se está VISUALIZANDO.
                // 5 pasos: 20%, 40%, 60%, 80%, 100%
                const progressPercentage = ((currentStep + 1) / totalSteps) * 100;
                progressBar.style.width = `${progressPercentage}%`;

                // Subir al tope del módulo
                document.querySelector('.module-wrapper').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            // Event Listeners para navegación
            if (prevBtn) {
                prevBtn.addEventListener('click', () => {
                    if (currentStep > 0) {
                        showStep(currentStep - 1);
                    }
                });
            }
            if (nextBtn) {
                nextBtn.addEventListener('click', () => {
                    if (currentStep < totalSteps - 1) {
                        showStep(currentStep + 1);
                    }
                });
            }

            // --- 3. LÓGICA DE EVALUACIÓN DEL QUIZ (Actualizada para Proporcionalidad) ---
            const quizForm = document.getElementById('quiz-form');
            const quizSummaryDiv = document.getElementById('quiz-result-summary');

            // Respuestas correctas para el módulo de Proporcionalidad
            const correctAnswers = {
                question1: 'igualdad', // igualdad entre dos razones
                question2: '8',       // 4/8 = X/16 -> X=8
                question3: 'inversa',     // Velocidad sube, Tiempo baja.
                question4: 'true',     // 0.25 * 80 = 20
                question5: '25'       // 50% de 50 es 25
            };

            if (quizForm) {
                quizForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    evaluateQuiz();
                });
            }

            function normalizeInput(value) {
                // Normaliza para comparar números y texto
                return value.toString().trim().toLowerCase()
                            .replace(/\s/g, '') // Quita espacios en blanco
                            .replace(/[^\w\s]/gi, '') // Quita caracteres especiales
                            .replace('proporcionalidaddinversa', 'inversa')
                            .replace('proporcionalidaddirecta', 'directa')
                            .replace('proporcion', 'igualdad')
                            .replace('igualdadentredosrazones', 'igualdad');
            }
            
            function evaluateQuiz() {
                let score = 0;
                const totalQuestions = Object.keys(correctAnswers).length;

                // Limpiar estilos anteriores
                document.querySelectorAll('.option-box').forEach(box => {
                    box.classList.remove('correct-answer', 'incorrect-answer');
                });
                document.querySelectorAll('#quiz-form input:not([type="radio"])').forEach(input => {
                    input.classList.remove('correct-answer', 'incorrect-answer');
                });

                for (const [key, correctValue] of Object.entries(correctAnswers)) {
                    const questionElement = document.getElementById(key);
                    if (!questionElement) continue;
                    let userAnswer = null;
                    let isCorrect = false;

                    // Lógica para preguntas de tipo 'radio' (opción única)
                    if (questionElement.querySelector('input[type="radio"]')) {
                        const checkedInput = questionElement.querySelector('input[type="radio"]:checked');
                        if (checkedInput) {
                            userAnswer = normalizeInput(checkedInput.value);
                            isCorrect = userAnswer === normalizeInput(correctValue);
                            
                            // Aplicar estilo al contenedor de la opción
                            questionElement.querySelectorAll('input[type="radio"]').forEach(radioInput => {
                                const boxLabel = document.querySelector(`label[for="${radioInput.id}"]`);
                                if (!boxLabel) return;

                                const normalizedRadioValue = normalizeInput(radioInput.value);
                                if (normalizedRadioValue === userAnswer) {
                                    boxLabel.classList.add(isCorrect ? 'correct-answer' : 'incorrect-answer');
                                } else if (normalizedRadioValue === normalizeInput(correctValue)) {
                                    // Marcar la respuesta correcta (solo si la del usuario es incorrecta)
                                    if (!isCorrect) {
                                        boxLabel.classList.add('correct-answer');
                                    }
                                }
                            });
                        }
                    } 
                    // Lógica para preguntas de tipo 'text' o 'number'
                    else {
                        const inputElement = questionElement.querySelector('input, select');
                        if (inputElement) {
                            userAnswer = normalizeInput(inputElement.value);
                            isCorrect = userAnswer === normalizeInput(correctValue);

                            if (isCorrect) {
                                inputElement.classList.add('correct-answer');
                            } else {
                                inputElement.classList.add('incorrect-answer');
                            }
                        }
                    }

                    if (isCorrect) {
                        score++;
                    }
                }

                // Mostrar el resumen del resultado
                displayQuizSummary(score, totalQuestions);
            }

            function displayQuizSummary(score, totalQuestions) {
                quizSummaryDiv.style.display = 'block';
                quizSummaryDiv.classList.remove('summary-success', 'summary-fail');
                let feedbackText;
                let lang = localStorage.getItem('educardLang') || 'es';
                const translations = languageData[lang];

                if (score === totalQuestions) {
                    quizSummaryDiv.classList.add('summary-success');
                    feedbackText = translations.quiz_feedback_perfect.replace('{score}', score).replace('{total}', totalQuestions);
                } else if (score >= 3) { // 3 o más correctas
                    quizSummaryDiv.classList.add('summary-success');
                    feedbackText = translations.quiz_feedback_good.replace('{score}', score).replace('{total}', totalQuestions);
                } else {
                    quizSummaryDiv.classList.add('summary-fail');
                    feedbackText = translations.quiz_feedback_poor.replace('{score}', score).replace('{total}', totalQuestions);
                }
                
                quizSummaryDiv.innerHTML = feedbackText;
            }

            // --- 4. INICIALIZACIÓN ---
            
            // Lógica para el selector de idioma (copiado de modulo1.html)
            document.querySelectorAll('.language-selector').forEach(selector => {
                const currentFlag = selector.querySelector('.current-flag');
                const dropdown = selector.querySelector('.language-dropdown');
                
                // Si el selector no está activo, no tiene evento click para abrir
                currentFlag.addEventListener('click', (e) => {
                    e.stopPropagation(); // Evita que se cierre por el body.click
                    // Cerrar otros dropdowns antes de abrir este
                    document.querySelectorAll('.language-dropdown').forEach(d => {
                        if (d !== dropdown) d.classList.remove('active');
                    });
                    dropdown.classList.toggle('active');
                });

                // Manejar la selección de idioma dentro del dropdown
                selector.querySelectorAll('.language-dropdown a').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const newLang = link.dataset.lang;
                        applyTranslation(newLang);
                        localStorage.setItem('educardLang', newLang); // Guardar la preferencia
                        document.querySelectorAll('.language-dropdown').forEach(d => d.classList.remove('active'));
                    });
                });
            });

            // Aplicar traducción inicial (o cargar preferencia)
            const savedLang = localStorage.getItem('educardLang') || 'es';
            applyTranslation(savedLang);

            // 3. Inicializar Módulo de Pasos (Ejecuta la función de navegación)
            if (steps.length > 0) {
                showStep(0);
            }
        });
    </script>

</body>
</html>